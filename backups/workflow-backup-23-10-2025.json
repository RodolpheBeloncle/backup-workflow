{"createdAt":"2025-07-24T15:34:58.044Z","updatedAt":"2025-10-23T09:15:04.931Z","id":"TFupHJyiscU8CH8X","name":"backup","active":false,"isArchived":false,"nodes":[{"parameters":{"assignments":{"assignments":[{"id":"a3c79aeb-0fdc-4bb5-b55e-d041dab2a9d0","name":"=datetime","value":"={{$now.format(\"dd-MM-yyyy\")}}","type":"string"}]},"options":{}},"id":"435975ef-b2e4-4af5-ad2c-bac1fca39880","name":"D√©finir la date/heure","type":"n8n-nodes-base.set","position":[-1904,-368],"typeVersion":3.4,"notesInFlow":true},{"parameters":{"operation":"toJson","mode":"each","binaryPropertyName":"={{ $json.id }}","options":{}},"id":"ebe2344b-0830-420a-b994-f30eec90fc84","name":"Convertir en fichier JSON","type":"n8n-nodes-base.convertToFile","typeVersion":1.1,"position":[-1232,-368],"notesInFlow":true},{"parameters":{"resource":"file","owner":{"__rl":true,"mode":"name","value":"={{ $('Get a repository').item.json.owner.login }}"},"repository":{"__rl":true,"value":"={{ $('Get a repository').item.json.name }}","mode":"name"},"filePath":"=backups/workflow-{{$('Get many workflows').item.json.name}}-{{ $('D√©finir la date/heure').item.json.datetime }}.json","binaryData":true,"binaryPropertyName":"={{ $binary.keys()[0] }}","commitMessage":"=backup du {{ $('D√©finir la date/heure').item.json.datetime }}-{{$('Get many workflows').item.json.name }}"},"id":"26067467-de52-4efc-83a2-83960c6a7c07","name":"Commit vers GitHub","type":"n8n-nodes-base.github","typeVersion":1,"position":[-976,-368],"notesInFlow":true,"webhookId":"0686c39a-7e3e-4c7e-9659-ac783a7f13da","credentials":{"githubApi":{"id":"68kMC96XlKY3sf7J","name":"GitHub account"}}},{"parameters":{"content":"‚è∞ **D√©clencheur planifi√©**\nLance automatiquement le workflow tous les jours (modifiable via les param√®tres de fr√©quence)."},"type":"n8n-nodes-base.stickyNote","position":[-2224,-176],"typeVersion":1,"id":"4fd31280-25f4-4dd4-9a4a-7e200efe0ffb","name":"Note - Schedule Trigger"},{"parameters":{"content":"üïí **Capture la date/heure**\nCr√©e une variable `datetime` contenant l'instant d'ex√©cution du workflow (`{{$now}}`)."},"type":"n8n-nodes-base.stickyNote","position":[-2016,-560],"typeVersion":1,"id":"372f0d74-b679-43a3-8960-91a6422bbaaa","name":"Note - Set DateTime"},{"parameters":{"content":"üì¶ **Connexion au repo GitHub**\nR√©cup√®re les infos du repo cible (`n8n-workflows-backup`) pour effectuer des commits plus loin dans le flow."},"type":"n8n-nodes-base.stickyNote","position":[-1744,-560],"typeVersion":1,"id":"650d5b2f-d537-4acb-9812-9f5175220304","name":"Note - Get GitHub Repo"},{"parameters":{"content":"üìÑ **Lister les workflows n8n**\nUtilise l'API de n8n pour r√©cup√©rer tous les workflows actifs de l'instance."},"type":"n8n-nodes-base.stickyNote","position":[-1488,-560],"typeVersion":1,"id":"44dd728b-116a-4d22-9db4-89aa6f6b54ee","name":"Note - Get Workflows"},{"parameters":{"content":"üìÅ **Convertir en fichier**\nTransforme chaque workflow JSON en fichier binaire `.json` pour pouvoir le stocker dans GitHub."},"type":"n8n-nodes-base.stickyNote","position":[-1232,-560],"typeVersion":1,"id":"ae0f7c9b-0e4e-44e4-be82-48a203b6de03","name":"Note - Convert to File"},{"parameters":{"content":"‚¨ÜÔ∏è **Commit vers GitHub**\nAjoute chaque fichier workflow dans le repo `n8n-workflows-backup` avec horodatage dans le nom et le commit."},"type":"n8n-nodes-base.stickyNote","position":[-976,-560],"typeVersion":1,"id":"774d5655-5339-41f3-ae8e-78a45a19d725","name":"Note - GitHub Upload"},{"parameters":{"content":"üßπ **Suppression fichiers GitHub** *(d√©sactiv√©)*\nPr√©vu pour effacer d'anciens backups dans le repo. Utile pour gestion de r√©tention automatique.","color":3},"type":"n8n-nodes-base.stickyNote","position":[-1248,32],"typeVersion":1,"id":"e50c6ddc-0b89-4763-9a3c-37d9062fee45","name":"Note - GitHub Delete"},{"parameters":{"content":"üìã **Lister les fichiers du repo** *(d√©sactiv√©)*\nPermet de parcourir tous les fichiers existants dans le repo. Peut √™tre utilis√© pour √©viter les doublons ou purger.","color":3},"type":"n8n-nodes-base.stickyNote","position":[-1568,32],"typeVersion":1,"id":"ca9113fb-4449-4bb5-a7bb-e18074851470","name":"Note - GitHub List"},{"parameters":{"resource":"file","operation":"list","owner":{"__rl":true,"value":"={{ $json.owner.login }}","mode":"name"},"repository":{"__rl":true,"value":"={{ $json.name }}","mode":"name"},"filePath":"=backups"},"type":"n8n-nodes-base.github","typeVersion":1,"position":[-1488,-160],"id":"0dd47ce4-e182-4de9-8e0c-c4e1d89af988","name":"Lister les fichiers du repo","webhookId":"b0071811-bc34-48bd-a1a6-8b5961746478","credentials":{"githubApi":{"id":"68kMC96XlKY3sf7J","name":"GitHub account"}}},{"parameters":{"resource":"file","operation":"delete","owner":{"__rl":true,"value":"={{ $('Get a repository').item.json.owner.login }}","mode":"name"},"repository":{"__rl":true,"value":"={{ $('Get a repository').item.json.name }}","mode":"name"},"filePath":"={{ $json.path }}","commitMessage":"=delete file {{ $json.name }}"},"type":"n8n-nodes-base.github","typeVersion":1,"position":[-1248,-160],"id":"14b77c50-3978-4596-aa0d-17ba457da2c2","name":"Suppression fichiers GitHub","webhookId":"7c42d1aa-bcf6-4e81-9626-96ca21fba241","credentials":{"githubApi":{"id":"68kMC96XlKY3sf7J","name":"GitHub account"}}},{"parameters":{"filters":{},"requestOptions":{}},"type":"n8n-nodes-base.n8n","typeVersion":1,"position":[-1504,-368],"id":"c0957cd5-ec63-443d-ae7c-6fea9376cd04","name":"Get many workflows","notesInFlow":true,"credentials":{"n8nApi":{"id":"YxBBTUFGGqjDr1fX","name":"n8n account"}}},{"parameters":{"resource":"repository","operation":"get","owner":{"__rl":true,"value":"https://github.com/RodolpheBeloncle","mode":"url"},"repository":{"__rl":true,"value":"backup-workflow","mode":"list","cachedResultName":"backup-workflow","cachedResultUrl":"https://github.com/RodolpheBeloncle/backup-workflow"}},"type":"n8n-nodes-base.github","typeVersion":1.1,"position":[-1744,-368],"id":"ee97606b-23b3-43e1-b58b-0dadbc28432e","name":"Get a repository","webhookId":"efc7ec89-8175-4c95-907a-0f9d1a7d199f","notesInFlow":true,"credentials":{"githubApi":{"id":"68kMC96XlKY3sf7J","name":"GitHub account"}}},{"parameters":{},"type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[-2112,-368],"id":"eac4c2f7-b1e9-454b-8efa-e8e34825fcec","name":"Declencheur","notesInFlow":true}],"connections":{"D√©finir la date/heure":{"main":[[{"node":"Get a repository","type":"main","index":0}]]},"Convertir en fichier JSON":{"main":[[{"node":"Commit vers GitHub","type":"main","index":0}]]},"Lister les fichiers du repo":{"main":[[{"node":"Suppression fichiers GitHub","type":"main","index":0}]]},"Get many workflows":{"main":[[{"node":"Convertir en fichier JSON","type":"main","index":0}]]},"Get a repository":{"main":[[{"node":"Get many workflows","type":"main","index":0},{"node":"Lister les fichiers du repo","type":"main","index":0}]]},"Declencheur":{"main":[[{"node":"D√©finir la date/heure","type":"main","index":0}]]}},"settings":{"executionOrder":"v1","saveDataErrorExecution":"none","callerPolicy":"workflowsFromSameOwner"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"4512d574-4fd8-4a00-9ae0-c54d18f2b500","triggerCount":0,"shared":[{"createdAt":"2025-08-14T07:14:52.888Z","updatedAt":"2025-08-14T07:14:52.888Z","role":"workflow:owner","workflowId":"TFupHJyiscU8CH8X","projectId":"TAg2OWp8a2XzOVPs"}],"tags":[]}